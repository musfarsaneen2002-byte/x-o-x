<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic Tac Toe</title>

<link rel="manifest" href="manifest.json">

<style>
:root{
  --bg:#ffffff;
  --card:#ffffff;
  --text:#222;
  --accent:#667eea;
}
.dark{
  --bg:#121212;
  --card:#1e1e1e;
  --text:#f5f5f5;
  --accent:#ff9800;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:var(--bg);
  font-family:system-ui;
  color:var(--text);
}
.container{
  width:100%;
  max-width:360px;
  background:var(--card);
  padding:16px;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
}
h1{text-align:center;margin-bottom:6px}
.subtitle{text-align:center;color:gray;margin-bottom:12px}
.board{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  background:#ccc;
  padding:8px;
  border-radius:12px;
}
.cell{
  aspect-ratio:1/1;
  font-size:2rem;
  font-weight:bold;
  border:none;
  border-radius:10px;
  cursor:pointer;
  transition: transform .15s ease, background .2s;
    
}
.cell:active{
  transform: scale(0.9);
}
.cell.x{color:#667eea}
.cell.o{color:#e91e63}
.info{text-align:center;margin:10px 0}
.controls{display:flex;gap:8px;margin-top:10px}
button,select{
  flex:1;
  padding:8px;
  border-radius:8px;
  border:none;
  cursor:pointer;
}
.dark-toggle{background:var(--accent);color:#fff}
</style>
</head>

<body>
<div class="container">
<h1>üéÆ Tic Tac Toe</h1>
<p class="subtitle">PWA Game</p>

<div class="info" id="turn">Player X's Turn</div>

<select id="mode">
  <option value="human">üë• Player vs Player</option>
  <option value="computer" selected>ü§ñ Player vs Computer</option>
</select>

<div class="board">
  <button class="cell" data-i="0"></button>
  <button class="cell" data-i="1"></button>
  <button class="cell" data-i="2"></button>
  <button class="cell" data-i="3"></button>
  <button class="cell" data-i="4"></button>
  <button class="cell" data-i="5"></button>
  <button class="cell" data-i="6"></button>
  <button class="cell" data-i="7"></button>
  <button class="cell" data-i="8"></button>
</div>

<div class="controls">
  <button onclick="resetGame()">üîÑ Reset</button>
  <button class="dark-toggle" onclick="toggleDark()">üåô</button>
</div>
</div>

<script>
    let scores = JSON.parse(localStorage.getItem('scores')) || {X:0,O:0,D:0};

// üîä Sounds
const clickSound=new Audio('./sounds/click.mp3');
const winSound=new Audio('./sounds/win.mp3');
const drawSound=new Audio('./sounds/draw.mp3');

// Unlock sound (mobile fix)
document.body.addEventListener('click',()=>{
  clickSound.play().then(()=>{
    clickSound.pause();clickSound.currentTime=0;
  });
},{once:true});

// Game Logic
const cells=document.querySelectorAll('.cell');
const turn=document.getElementById('turn');
const modeSelect=document.getElementById('mode');

let board=Array(9).fill('');
let player='X';

const wins=[
[0,1,2],[3,4,5],[6,7,8],
[0,3,6],[1,4,7],[2,5,8],
[0,4,8],[2,4,6]
];

cells.forEach(cell=>{
cell.onclick=()=>{
  const i=cell.dataset.i;
  if(board[i])return;

  clickSound.currentTime=0;
  clickSound.play();

  board[i]=player;
  cell.textContent=player;
  cell.classList.add(player.toLowerCase());
  cell.disabled=true;

  const result=checkWin();
  if(result){
    result==='D'?drawSound.play():winSound.play();
    setTimeout(resetGame,800);
    return;
  }

  player=player==='X'?'O':'X';
  turn.textContent=`Player ${player}'s Turn`;

  if(modeSelect.value==='computer' && player==='O'){
    setTimeout(computerMove,400);
  }
};
});

function computerMove(){
  let move = findBestMove();
  if(move !== null){
    cells[move].click();
  }
}

function findBestMove(){
  // 1Ô∏è‚É£ Try to WIN
  for(let i=0;i<9;i++){
    if(board[i]===''){
      board[i]='O';
      if(checkWin()==='O'){ board[i]=''; return i; }
      board[i]='';
    }
  }

  // 2Ô∏è‚É£ BLOCK player
  for(let i=0;i<9;i++){
    if(board[i]===''){
      board[i]='X';
      if(checkWin()==='X'){ board[i]=''; return i; }
      board[i]='';
    }
  }

  // 3Ô∏è‚É£ CENTER
  if(board[4]==='') return 4;

  // 4Ô∏è‚É£ CORNERS
  const corners=[0,2,6,8];
  for(let c of corners){
    if(board[c]==='') return c;
  }

  // 5Ô∏è‚É£ ANY
  for(let i=0;i<9;i++){
    if(board[i]==='') return i;
  }

  return null;
}

function checkWin(){
  for(let [a,b,c] of wins){
    if(board[a]&&board[a]===board[b]&&board[a]===board[c]) return board[a];
  }
  return board.includes('')?null:'D';
}

function resetGame(){
  board.fill('');
  cells.forEach(c=>{
    c.textContent='';
    c.className='cell';
    c.disabled=false;
  });
  player='X';
  turn.textContent="Player X's Turn";
}

// üåô Dark Mode
function toggleDark(){
  document.body.classList.toggle('dark');
}

// üì± PWA
if('serviceWorker'in navigator){
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
